# C4 Model 가이드

## 개념

4단계 zoom-in 아키텍처 다이어그램.

```
C1: System Context  - 가장 높은 레벨 (새가 보는 시점)
        ↓
C2: Container       - 주요 기술 단위 (서비스, DB 등)
        ↓
C3: Component       - 컨테이너 내부 구성요소
        ↓
C4: Code            - 실제 코드 (보통 생략)
```

---

## C1: System Context

### 목적

- 시스템 경계 정의
- 외부 시스템/사용자와의 관계

### 포함 요소

```
┌─────────────────────────────────────────────────────────────────┐
│                       System Context                            │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│   [Person]              [Your System]           [External       │
│   사용자들                                       System]        │
│      │                      │                      │            │
│      └──────────────────────┼──────────────────────┘            │
│                         연결 관계                               │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### 질문

- 누가 이 시스템을 사용하는가?
- 어떤 외부 시스템과 연결되는가?
- 데이터는 어디서 오고 어디로 가는가?

---

## C2: Container Diagram

### 목적

- 시스템을 구성하는 주요 기술 단위
- 기술 선택 표현

### 포함 요소

```
┌─────────────────────────────────────────────────────────────────┐
│                       Your System                               │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│   ┌─────────┐    ┌─────────┐    ┌─────────┐    ┌─────────┐    │
│   │   CLI   │    │   API   │    │ Worker  │    │Database │    │
│   │ (Typer) │───▶│(FastAPI)│───▶│(Celery) │───▶│(Postgres│    │
│   └─────────┘    └─────────┘    └─────────┘    └─────────┘    │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### Container 유형

| 유형 | 예시 |
|------|------|
| Application | Web App, CLI, Mobile App |
| Service | API Server, Worker |
| Data Store | Database, File System, Cache |
| External | Third-party API |

### 작성 팁

- 기술 스택 명시 (괄호 안에)
- 통신 방향 화살표
- 각 Container의 책임 한 줄

---

## C3: Component Diagram

### 목적

- Container 내부 구조
- 주요 모듈/클래스

### 포함 요소

```
┌─────────────────────────────────────────────────────────────────┐
│                     API Container                               │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│   ┌──────────────┐  ┌──────────────┐  ┌──────────────┐         │
│   │   Router     │  │   Service    │  │  Repository  │         │
│   │              │─▶│              │─▶│              │         │
│   │  HTTP 핸들링 │  │  비즈니스    │  │  데이터 접근 │         │
│   └──────────────┘  └──────────────┘  └──────────────┘         │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### 작성 팁

- 핵심 Component만 (너무 상세 X)
- 책임 명확히
- 의존성 방향 표시

---

## C4: Code (보통 생략)

실제 코드가 문서 역할. 필요 시 클래스 다이어그램.

---

## 추가 다이어그램

### Data Flow

데이터가 시스템을 어떻게 흐르는지.

```
User Input → Validation → Processing → Storage → Response
```

### State Flow (상태 기반 시스템)

```
START → State1 → State2 → ... → END
```

---

## 문서 템플릿

```markdown
# C4 Model

## C1: System Context

[다이어그램]

### External Entities
| Entity | 설명 | 상호작용 |
|--------|------|----------|
| User   | ...  | ...      |

## C2: Container Diagram

[다이어그램]

### Containers
| Container | 기술 | 책임 |
|-----------|------|------|
| CLI       | Typer | 사용자 인터페이스 |

## C3: Component Diagram

### [Container Name]

[다이어그램]

| Component | 책임 |
|-----------|------|
| Router    | HTTP 핸들링 |

## Data Flow

[설명]

## Directory Structure

```
project/
├── src/
│   └── ...
└── tests/
```
```

---

## ASCII 다이어그램 팁

```
박스:
┌─────────┐
│  Title  │
└─────────┘

화살표:
───▶  (단방향)
◀───▶ (양방향)
- - - ▶ (비동기/옵션)

계층:
│
├──
└──
```

---

## 주의사항

1. **적절한 추상화** - C2에서 모든 파일 나열 X
2. **기술 스택 명시** - "(Python)", "(Redis)" 등
3. **화살표 방향** - 의존성/데이터 흐름 명확히
4. **범례 필요 시** - 색상/모양 의미 설명
